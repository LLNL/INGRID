

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>interpol module &mdash; ingrid  documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="line_tracing module" href="line_tracing.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> ingrid
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="introduction.html">INGRID Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="getting_started.html">Getting Started</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">Module Documentation</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="ingrid.html">ingrid module</a></li>
<li class="toctree-l2"><a class="reference internal" href="topologies.html">topologies package</a></li>
<li class="toctree-l2"><a class="reference internal" href="utils.html">utils module</a></li>
<li class="toctree-l2"><a class="reference internal" href="geometry.html">geometry module</a></li>
<li class="toctree-l2"><a class="reference internal" href="line_tracing.html">line_tracing module</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">interpol module</a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">ingrid</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
          <li><a href="modules.html">Module Documentation</a> &raquo;</li>
        
      <li>interpol module</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/interpol.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="module-interpol">
<span id="interpol-module"></span><h1>interpol module<a class="headerlink" href="#module-interpol" title="Permalink to this headline">¶</a></h1>
<p>Module containing Bicubic class and EfitData class for handling all interpolation
related computations.</p>
<dl class="py class">
<dt id="interpol.EfitData">
<em class="property">class </em><code class="sig-prename descclassname">interpol.</code><code class="sig-name descname">EfitData</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">rmin</span><span class="o">=</span><span class="default_value">0.0</span></em>, <em class="sig-param"><span class="n">rmax</span><span class="o">=</span><span class="default_value">1.0</span></em>, <em class="sig-param"><span class="n">nr</span><span class="o">=</span><span class="default_value">10</span></em>, <em class="sig-param"><span class="n">zmin</span><span class="o">=</span><span class="default_value">0.0</span></em>, <em class="sig-param"><span class="n">zmax</span><span class="o">=</span><span class="default_value">2.0</span></em>, <em class="sig-param"><span class="n">nz</span><span class="o">=</span><span class="default_value">20</span></em>, <em class="sig-param"><span class="n">rcenter</span><span class="o">=</span><span class="default_value">1.6955</span></em>, <em class="sig-param"><span class="n">bcenter</span><span class="o">=</span><span class="default_value">- 2.1094041</span></em>, <em class="sig-param"><span class="n">rlimiter</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">zlimiter</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">rmagx</span><span class="o">=</span><span class="default_value">0.0</span></em>, <em class="sig-param"><span class="n">zmagx</span><span class="o">=</span><span class="default_value">0.0</span></em>, <em class="sig-param"><span class="n">name</span><span class="o">=</span><span class="default_value">'unnamed'</span></em>, <em class="sig-param"><span class="n">parent</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#interpol.EfitData" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Structure to store the rectangular grid of psi data. It uses
cylindrical coordinates, where R and Z are similar to the cartesian
x and y. The phi components goes away due to the symmetry of a
tokamak.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rmin</strong> (<em>float</em><em>, </em><em>optional</em>) – left boundary of the grid</p></li>
<li><p><strong>rmax</strong> (<em>float</em><em>, </em><em>optional</em>) – right boundary</p></li>
<li><p><strong>nr</strong> (<em>int</em><em>, </em><em>optional</em>) – number of grid points in the R direction</p></li>
<li><p><strong>zmin</strong> (<em>float</em><em>, </em><em>optional</em>) – bottom boundary for the grid</p></li>
<li><p><strong>zmax</strong> (<em>float</em><em>, </em><em>optional</em>) – top boundary</p></li>
<li><p><strong>nz</strong> (<em>int</em><em>, </em><em>optional</em>) – number of grid points in the Z direction</p></li>
<li><p><strong>name</strong> (<em>str</em><em>, </em><em>optional</em>) – Specify the title of the figure the data will be plotted on.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="interpol.EfitData.Calculate_PDeriv">
<code class="sig-name descname">Calculate_PDeriv</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">unit_spacing</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="headerlink" href="#interpol.EfitData.Calculate_PDeriv" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate partial derivatives at grid nodes.</p>
<p>Use finite differences to increase accuracy at the
boundaries.</p>
<p>These formulas are derived from Taylor Series representations.
Values for vr, vz, and vrz are produced and saved within the
grid structure.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>unit_spacing</strong> (<em>bool</em><em>, </em><em>optional</em>) – Allow for the derivatives to be calculated on a unit cell,
or on a grid with any other spacing. Default is true.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="interpol.EfitData.Gradient">
<code class="sig-name descname">Gradient</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">xy</span><span class="p">:</span> <span class="n">tuple</span></em><span class="sig-paren">)</span> &#x2192; numpy.ndarray<a class="headerlink" href="#interpol.EfitData.Gradient" title="Permalink to this definition">¶</a></dt>
<dd><p>Combines the first partial derivatives to solve the system for
maximum, minimum, and saddle locations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>xy</strong> (<em>array-like</em>) – Contains x and y. Ex: xy = (x0, y0).</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>F</strong> (<em>array</em>) – Vector function to be used in find root.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="interpol.EfitData.Hessian">
<code class="sig-name descname">Hessian</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">xy</span><span class="p">:</span> <span class="n">tuple</span></em><span class="sig-paren">)</span> &#x2192; numpy.ndarray<a class="headerlink" href="#interpol.EfitData.Hessian" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the Hessian at a point.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>xy</strong> (<em>array-like</em>) – Contains x and y. Ex: xy = (x0, y0).</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>H</strong> (<em>array</em>) – Numpy array of shape (2, 2) representing the Hessian at xy.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="interpol.EfitData.PlotLevel">
<code class="sig-name descname">PlotLevel</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">level</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="default_value">1.0</span></em>, <em class="sig-param"><span class="n">color</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="default_value">'red'</span></em>, <em class="sig-param"><span class="n">label</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="default_value">''</span></em>, <em class="sig-param"><span class="n">linestyles</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="default_value">'solid'</span></em><span class="sig-paren">)</span> &#x2192; None<a class="headerlink" href="#interpol.EfitData.PlotLevel" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot a psi level and provide it a label.</p>
<p>This function is useful for management of psi boundaries
such as ‘psi_pf’, ‘psi_core’, etc and ensuring the contour will
be properly replotted (no duplicate of same label).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>level</strong> (<em>float</em><em>, </em><em>optional</em>) – Psi level to plot. Default to 1.0 (separatrix of normalized psi)</p></li>
<li><p><strong>color</strong> (<em>str</em><em>, </em><em>optional</em>) – Color to pass to matplotlib contour function</p></li>
<li><p><strong>label</strong> (<em>str</em><em>, </em><em>optional</em>) – Label to associate with the psi level</p></li>
<li><p><strong>linestyles</strong> (<em>str</em><em>, </em><em>optional</em>) – Line style to pass to matplotlib contour function</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="interpol.EfitData.PsiFunction">
<code class="sig-name descname">PsiFunction</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">xy</span></em><span class="sig-paren">)</span><a class="headerlink" href="#interpol.EfitData.PsiFunction" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="interpol.EfitData.clear_plot">
<code class="sig-name descname">clear_plot</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#interpol.EfitData.clear_plot" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="interpol.EfitData.get_psi">
<code class="sig-name descname">get_psi</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">r0</span></em>, <em class="sig-param"><span class="n">z0</span></em>, <em class="sig-param"><span class="n">tag</span><span class="o">=</span><span class="default_value">'v'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#interpol.EfitData.get_psi" title="Permalink to this definition">¶</a></dt>
<dd><p>find grid cell encompassing (r0,z0)
note: grid is the crude grid. Uses Bicubic Interpolation
to calculate the exact value at the point. Useful for
finding information inbetween grid points.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>r0</strong> (<em>float</em>) – R coordinate of the point of interest</p></li>
<li><p><strong>z0</strong> (<em>float</em>) – Z coordinate of same point.</p></li>
<li><p><strong>tag</strong> (<em>str</em><em>, </em><em>optional</em>) – tag is the type of derivative we want: v, vr, vz, vrz
if nothing is provided, it assumes no derivative (v).</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>float</em> – Value of psi or its derviative at the coordinate specified.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="interpol.EfitData.get_v">
<code class="sig-name descname">get_v</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">tag</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="default_value">'v'</span></em><span class="sig-paren">)</span> &#x2192; numpy.ndarray<a class="headerlink" href="#interpol.EfitData.get_v" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the entire array of v, vr, vz, or vrz.
If you want a single value use self.get_psi</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>tag</strong> (<em>str</em><em>, </em><em>optional</em>) – Specify the type of derivative. ‘v’, ‘vr’, ‘vz’, ‘vrz’</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>ndarray</em> – value of the function or its derivative over the entire
grid.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="interpol.EfitData.locate_cell">
<code class="sig-name descname">locate_cell</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">r0</span><span class="p">:</span> <span class="n">float</span></em>, <em class="sig-param"><span class="n">z0</span><span class="p">:</span> <span class="n">float</span></em><span class="sig-paren">)</span> &#x2192; dict<a class="headerlink" href="#interpol.EfitData.locate_cell" title="Permalink to this definition">¶</a></dt>
<dd><p>Locate the cell on the rectangular grid that surrounds
a point of interest.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>r0</strong> (<em>float</em>) – R or x coordinate of the point</p></li>
<li><p><strong>z0</strong> (<em>float</em>) – Z or y coordinate of the tested point</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>A dict with node indices of grid cell encompassing tested point</em></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="interpol.EfitData.plot_data">
<code class="sig-name descname">plot_data</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">nlevs</span><span class="o">=</span><span class="default_value">30</span></em>, <em class="sig-param"><span class="n">interactive</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">fig</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">ax</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">view_mode</span><span class="o">=</span><span class="default_value">'filled'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#interpol.EfitData.plot_data" title="Permalink to this definition">¶</a></dt>
<dd><p>generates the plot that we will be able to manipulate
using the root finder</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>nlev</strong> (<em>int</em><em>, </em><em>optional</em>) – number of levels we want to be plotted</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="interpol.EfitData.plot_levels">
<code class="sig-name descname">plot_levels</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">level</span><span class="o">=</span><span class="default_value">1.0</span></em>, <em class="sig-param"><span class="n">color</span><span class="o">=</span><span class="default_value">'red'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#interpol.EfitData.plot_levels" title="Permalink to this definition">¶</a></dt>
<dd><p>This function is useful if you need to quickly see
where a particular line of constant psi is. It in’t able to store
points of intersection, and cannot be generalized. If you
need just a segment of psi, use the draw_lines method in the
line tracing class.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>level</strong> (<em>float</em><em>, </em><em>optional</em>) – Value of psi you wish to see</p></li>
<li><p><strong>color</strong> (<em>str</em><em>, </em><em>optional</em>) – color of the line.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="interpol.EfitData.set_v">
<code class="sig-name descname">set_v</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">value</span></em>, <em class="sig-param"><span class="n">coords</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">tag</span><span class="o">=</span><span class="default_value">'v'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#interpol.EfitData.set_v" title="Permalink to this definition">¶</a></dt>
<dd><p>sets a value for v, vr, vz, or vrz.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>value</strong> (<em>ndarray</em><em>, </em><em>float</em>) – new set of values for the function. Must be the same shape
as the grid if you are setting every value. Also accepts a
single float for setting spevific values.</p></li>
<li><p><strong>coords</strong> (<em>array-like</em><em>, </em><em>optional</em>) – The coordinates of a single value, if you are setting one value.
if set to none, it will set the entire value</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt id="interpol.Bicubic">
<code class="sig-prename descclassname">interpol.</code><code class="sig-name descname">Bicubic</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">f</span></em>, <em class="sig-param"><span class="n">fx</span><span class="p">:</span> <span class="n">array - like</span></em>, <em class="sig-param"><span class="n">fy</span><span class="p">:</span> <span class="n">array - like</span></em>, <em class="sig-param"><span class="n">fxy</span><span class="p">:</span> <span class="n">array - like</span></em>, <em class="sig-param"><span class="n">x0</span><span class="p">:</span> <span class="n">float</span></em>, <em class="sig-param"><span class="n">y0</span><span class="p">:</span> <span class="n">float</span></em>, <em class="sig-param"><span class="n">derivs</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="default_value">''</span></em><span class="sig-paren">)</span> &#x2192; float<a class="headerlink" href="#interpol.Bicubic" title="Permalink to this definition">¶</a></dt>
<dd><p>Bicubic interpolation on unit square [0,1]x[0,1].
Returns the value of the interpolated polynomial at the given interior
point (x0,y0).
f, fx, fy, fxy can be arrays, lists, tulpes etc.
They must each have four values and are ordered:</p>
<div class="math notranslate nohighlight">
\[f_{i,j}, f_{i,j+1}, f_{i+1,j}, f_{i+1,j+1}.\]</div>
<p>This is the natural order produced by the locate cell method,
in the EfitData.EFit_Data class, which how
this function is usually called.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>f</strong> (<em>array-like</em>) – Contains the value of the function of each cell coordinate.</p></li>
<li><p><strong>fx</strong> (<em>array-like</em>) – Contains the x or R derivative</p></li>
<li><p><strong>fy</strong> (<em>array-like</em>) – Contains the y or Z derivative</p></li>
<li><p><strong>fxy</strong> (<em>array-like</em>) – Contains the cross derivative, xy or RZ</p></li>
<li><p><strong>x0</strong> (<em>float</em>) – Normalized x or R coordinate of the point of interest</p></li>
<li><p><strong>y0</strong> (<em>float</em>) – Normalized y  or Z coordinate of the point</p></li>
<li><p><strong>derivs</strong> (<em>str</em><em>, </em><em>optional</em>) – Contains the tag for the type of derivative we want.
Accepts ‘v’, ‘vr’, ‘vz’, ‘vrz’</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><em>The value of the function of its derivative at a given location</em></p>
</dd>
</dl>
</dd></dl>

</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
      
        <a href="line_tracing.html" class="btn btn-neutral float-left" title="line_tracing module" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, Bryan Max Garcia

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>